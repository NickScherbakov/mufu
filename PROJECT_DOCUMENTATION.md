# ChatGPT Video - Документация проекта

## Общее описание проекта

ChatGPT Video — это проект для автоматизации создания образовательного видеоконтента с использованием нескольких моделей искусственного интеллекта. Система извлекает текст из документов (например, PDF файлов), обрабатывает его с помощью различных языковых моделей, генерирует изображения и озвучку, а затем компонует все материалы в готовое видео. 

### Цели проекта
- Автоматизация создания образовательного видеоконтента
- Разработка гибкой системы, способной работать с различными AI API (Ollama, LlamaCPP, YandexGPT)
- Оптимизация работы с русскоязычным контентом
- Внедрение системы саморазвития и самоанализа с помощью AI-ассистента

### Особенности проекта
- Модульная структура с четким разделением ответственности
- Расширенная система логирования для отслеживания всех этапов работы
- Поддержка различных AI API для обеспечения гибкости
- Интеграция с системой самоанализа и план-факт чекером для постоянного улучшения

## Архитектура проекта

Проект имеет модульную архитектуру с четким разделением функциональности по компонентам:

```
┌────────────────────┐  ┌────────────────────┐  ┌────────────────────┐
│   Ввод данных      │  │ Обработка контента │  │   Вывод данных     │
│ (extract_text.py)  │→ │ (simplify_text.py) │→ │ (compose_video.py) │
└────────────────────┘  │ (split_scenes.py)  │  └────────────────────┘
                        └────────────────────┘
                                  ↓
┌────────────────────┐  ┌────────────────────┐  ┌────────────────────┐
│   Генерация        │  │   Генерация        │  │      Модели        │
│   изображений      │  │     озвучки        │  │   (model_selector) │
│ (generate_image.py)│  │(generate_voice.py) │  └────────────────────┘
└────────────────────┘  └────────────────────┘
          ↑                      ↑                        ↑
          └──────────────────────┼────────────────────────┘
                                 ↓
                      ┌────────────────────┐
                      │     Ассистент      │
                      │ (assistant_manager)│
                      └────────────────────┘
                                 ↓
                      ┌────────────────────┐
                      │   Система логов    │
                      │    (logger.py)     │
                      └────────────────────┘
```

## Описание компонентов проекта

### Основные модули

#### 1. extract_text.py
**Цель**: Извлечение текстового содержимого из PDF файлов
**Функциональность**:
- Преобразование PDF в текст с сохранением структуры
- Обработка русскоязычного текста
- Предварительная очистка и нормализация текста

#### 2. simplify_text.py
**Цель**: Упрощение и адаптация извлеченного текста для видеоконтента
**Функциональность**:
- Адаптация сложных текстов для восприятия на слух
- Разделение на логические части
- Интеграция с различными языковыми моделями через model_selector
- Оптимизация текста для русского языка

#### 3. split_scenes.py
**Цель**: Разделение текста на отдельные сцены для видеомонтажа
**Функциональность**:
- Выделение логически завершенных частей текста
- Подготовка скриптов для каждой сцены
- Синхронизация текста с визуальными элементами

#### 4. generate_image.py
**Цель**: Создание визуального контента для видео
**Функциональность**:
- Генерация иллюстраций на основе текста сцены
- Адаптация визуальных элементов под содержимое
- Интеграция с внешними API для генерации изображений

#### 5. generate_voice.py
**Цель**: Создание аудиоконтента (озвучивание текста)
**Функциональность**:
- Озвучивание текста с учетом интонаций и пауз
- Поддержка русскоязычного озвучивания
- Оптимизация звука для образовательного контента

#### 6. compose_video.py
**Цель**: Компоновка финального видеоролика
**Функциональность**:
- Сборка видео из отдельных сцен
- Синхронизация аудио и визуальных элементов
- Добавление переходов и эффектов
- Экспорт в различные форматы

#### 7. model_selector.py
**Цель**: Выбор оптимальных моделей для обработки контента
**Функциональность**:
- Поддержка различных API (Ollama, LlamaCPP, YandexGPT)
- Динамический выбор наиболее подходящей модели для конкретного типа контента
- Балансировка между качеством и скоростью обработки
- Обработка ошибок при работе с API

#### 8. assistant_manager.py
**Цель**: Управление AI ассистентом для развития и анализа проекта
**Функциональность**:
- Непрерывная работа ассистента с циклом саморазвития
- Анализ производительности проекта
- Поддержка интеграции с LlamaCPP API
- Обновление файла PLAN-FACT-CHECKER.md с текущим прогрессом
- Предложения по оптимизации процессов

#### 9. logger.py
**Цель**: Всеобъемлющая система логирования для отслеживания всех процессов
**Функциональность**:
- Многоуровневая система логов (цели, действия, решения, результаты, ошибки)
- Экспорт логов в различные форматы (JSON, YAML)
- Генерация сводных отчетов о работе
- Контекстное логирование для анализа процессов

#### 10. utils.py
**Цель**: Утилиты общего назначения для поддержки всех модулей
**Функциональность**:
- Работа с конфигурационными файлами (.env)
- Общие функции для обработки текста
- Вспомогательные функции для всех модулей

### Вспомогательные файлы

#### setup_environment.ps1
**Цель**: Настройка среды разработки и запуск тестов
**Функциональность**:
- Создание и активация виртуального окружения
- Установка зависимостей из requirements.txt
- Создание структуры каталогов
- Запуск тестов (все или выборочно)

#### requirements.txt
**Содержимое**: Список всех зависимостей проекта, включая:
- Библиотеки для работы с PDF (PyPDF2/pdfminer)
- Библиотеки для работы с API (requests)
- Библиотеки для обработки текста (nltk, transformers)
- Библиотеки для генерации видео и аудио

#### PLAN-FACT-CHECKER.md
**Цель**: Отслеживание прогресса выполнения задач проекта
**Содержимое**:
- Запланированные функции и их текущий статус
- Метрики использования различных API
- Обнаруженные проблемы и их решения
- Рекомендации по оптимизации
- Автоматически обновляется через assistant_manager.py

#### TODO.md
**Цель**: Список текущих задач и планов развития проекта
**Содержимое**:
- Текущие приоритетные задачи
- Планы по улучшению функциональности
- Технические требования к реализации

#### prompts.md
**Цель**: Сборник промптов для работы с AI моделями
**Содержимое**:
- Промпты для упрощения текста
- Промпты для генерации изображений
- Промпты для улучшения голосового контента
- Шаблоны для работы с различными типами контента

## Тестовая инфраструктура

Проект имеет выделенную директорию `tests/` с набором тестовых файлов для проверки работоспособности каждого компонента системы.

#### api_connectivity_test.py
**Цель**: Проверка подключения и взаимодействия с различными API
**Функциональность**:
- Тестирование подключения к Ollama API с выводом списка доступных моделей
- Тестирование подключения к LlamaCPP API с выводом списка доступных моделей
- Тестирование подключения к YandexGPT API с выводом списка доступных моделей через OpenAI-совместимый интерфейс

#### test_pdf_extraction.py
**Цель**: Проверка корректности извлечения текста из PDF файлов
**Функциональность**:
- Проверка чтения PDF файла inputs/short-ege1.pdf
- Анализ извлеченного текста
- Сохранение текста в выходной файл для визуальной проверки

#### test_logger.py
**Цель**: Тестирование системы логирования
**Функциональность**:
- Проверка всех типов логирования (цели, действия, решения, результаты, ошибки)
- Симуляция полного цикла создания видео для отслеживания логов
- Экспорт логов в форматы JSON и YAML

#### test_ollama_api.py, test_llamacpp_api.py, test_yandexgpt_api.py
**Цель**: Индивидуальное тестирование каждого из поддерживаемых API
**Функциональность**:
- Проверка доступности API
- Тестирование простых запросов
- Вывод информации о доступных моделях

#### test_assistant_manager.py
**Цель**: Тестирование системы управления с ассистентом
**Функциональность**:
- Демонстрация полного цикла работы с ассистентом
- Проверка обновления PLAN-FACT-CHECKER.md
- Симуляция делегирования задач через различные API

## Непрерывный цикл работы с ассистентом

Система AI ассистента, основанная на LlamaCPP API, является одним из ключевых компонентов проекта, обеспечивающих его саморазвитие. Вот как работает этот цикл:

### Основной цикл работы ассистента

1. **Инициализация ассистента**:
   - При запуске система подключается к LlamaCPP API
   - Загружается история предыдущих взаимодействий
   - Устанавливаются цели и приоритеты на текущую сессию

2. **Анализ текущего состояния**:
   - Ассистент анализирует логи предыдущих сессий
   - Проверяет статус задач в PLAN-FACT-CHECKER.md
   - Оценивает качество работы каждого компонента системы

3. **Выполнение задач**:
   - Ассистент выбирает наиболее приоритетную задачу
   - Делегирует подзадачи соответствующим модулям
   - Контролирует процесс выполнения и собирает результаты

4. **Обновление план-факт анализа**:
   - По завершении задачи обновляется PLAN-FACT-CHECKER.md
   - Записываются метрики использования API
   - Документируются решенные проблемы
   - Обновляется прогресс по каждой задаче

5. **Самоанализ и улучшение**:
   - Анализ эффективности работы
   - Предложения по оптимизации процессов
   - Корректировка приоритетов
   - Добавление новых задач при необходимости

### Обновление PLAN-FACT-CHECKER.md

Файл PLAN-FACT-CHECKER.md является ключевым для отслеживания прогресса проекта и содержит:

1. **Таблицы прогресса для каждой задачи**:
   ```markdown
   | ID | Задача | Запланировано | Фактически | Прогресс |
   |----|--------|--------------|------------|----------|
   | 1  | Интеграция model_selector в simplify_text.py | 01.04.2025 | В процессе | 75% |
   ```

2. **Метрики использования API**:
   ```markdown
   #### Ollama API
   | Дата | Запросы | Успешные | Ошибки | Среднее время | Токены |
   |------|---------|----------|--------|---------------|--------|
   | 19.04.2025 | 42 | 40 | 2 | 0.87s | 13500 |
   ```

3. **Секции проблем и их решений**:
   ```markdown
   | Дата | Проблема | Решение | Статус |
   |------|---------|---------|--------|
   | 18.04.2025 | Ошибки при работе с кириллицей | Добавлена специальная обработка | Решено |
   ```

### Практическая реализация

В модуле `assistant_manager.py` для обеспечения непрерывной работы ассистента:

1. Создан класс `AssistantManager` с методом `delegate_task` для делегирования задач
2. Реализована функция `update_plan_fact_checker` для автоматического обновления
3. Используется циклическое выполнение задач с периодическими перерывами для анализа
4. Добавлена система сохранения истории взаимодействий для обучения

```python
# Пример бесконечного цикла работы ассистента
def run_assistant_loop():
    while True:
        # Анализ текущего состояния
        current_status = assistant.analyze_current_state()
        
        # Выбор и выполнение приоритетной задачи
        priority_task = assistant.select_priority_task(current_status)
        result = assistant.execute_task(priority_task)
        
        # Обновление план-факт чекера
        update_plan_fact_checker({
            "task_id": priority_task.id,
            "progress": result.progress,
            "api_type": result.api_used,
            "success": result.success_count,
            "errors": result.error_count
        })
        
        # Краткая пауза перед следующей итерацией
        time.sleep(REFRESH_INTERVAL)
```

## Рекомендации по развитию проекта

На основе анализа текущего состояния проекта, можно выделить следующие направления для дальнейшего развития:

1. **Улучшение работы с русскоязычным контентом**:
   - Интеграция специализированных моделей для русского языка
   - Оптимизация озвучки с учетом особенностей произношения

2. **Расширение возможностей интеграции**:
   - Поддержка дополнительных API (Claude, Gemini)
   - Разработка унифицированного интерфейса для работы с разными моделями

3. **Улучшение системы логирования и мониторинга**:
   - Добавление визуализации процесса работы
   - Интеграция с системами аналитики

4. **Оптимизация производительности**:
   - Параллельная обработка модулей где это возможно
   - Кэширование результатов для избежания повторных вызовов API

5. **Расширение тестового покрытия**:
   - Разработка интеграционных тестов для всего пайплайна
   - Автоматизация тестирования различных сценариев

## Заключение

Проект ChatGPT Video представляет собой комплексную систему для автоматизации создания образовательного видеоконтента с использованием различных AI-моделей. Благодаря модульной архитектуре и системе саморазвития на основе AI ассистента, проект имеет хорошие перспективы для постоянного улучшения и расширения функциональности.

Ключевой особенностью является интеграция с различными API (Ollama, LlamaCPP, YandexGPT) и автоматическое отслеживание прогресса с помощью PLAN-FACT-CHECKER.md, что позволяет системе анализировать свою эффективность и предлагать улучшения.